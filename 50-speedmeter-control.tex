\chapter{\label{c:speedmeter-control}Concept for the longitudinal control of the \SSM{} experiment}

\newcommand{\RT}{$\textrm{R}_{\textrm{T}}$}
\newcommand{\MINT}{$\textrm{M}_{\textrm{I}}$}
\newcommand{\MSIX}{$\textrm{M}_{\textrm{6}}$}
\newcommand{\MSEVEN}{$\textrm{M}_{\textrm{7}}$}
\newcommand{\MELEVEN}{$\textrm{M}_{\textrm{11}}$}
\newcommand{\MSIXTEEN}{$\textrm{M}_{\textrm{16}}$}

% \note{Copy and paste paper, but expand on some of the information. For instance, discuss more detail about the suspension servo design, each individual part of the control loop e.g. actuator response, etc.}

\section{Introduction}

The \SSM{} interferometer topology can potentially provide enhanced sensitivity to gravitational waves in the audio-band compared to equivalent Michelson interferometers. A challenge with the \SSM{} interferometer arises from the intrinsic lack of sensitivity at low frequencies where the velocity-proportional signal is smaller than the noise associated with the sensing of the signal. Using as an example the on-going proof-of-concept \SSM{} experiment in Glasgow, we quantify the problem and present a solution involving the extraction of a small displacement-proportional signal. This displacement signal can be combined with the existing velocity signal to enhance low frequency sensitivity, and we derive optimal filters to accomplish this for different signal strengths. We show that the extraction of the displacement signal for low frequency control purposes can be performed without reducing significantly the quantum non-demolition character of this type of interferometer.

\note{Some stuff to write about:}
\begin{itemize}
  \item powers, sidebands, etc...
  \item Control loop design / noise budget
  \item Inclusion of other noises, like seismic, thermal, electronic, etc. Calculation of noise budget.
  \item Suspension hierarchical gain (handling ESD / coil ranges) (see labbook posts)
     \begin{itemize}
        \item Crossover at ~200 Hz, show calculation of how high a frequency we need to control the arms to keep the power in there (see labbook)
     \end{itemize}
  \item Photodetector transimpedance
    \begin{itemize}
      \item Set transimpedance so that signals are ~1 V...?
    \end{itemize}
  \item Mixing displacement and velocity signals
  \item CDS overall gain setting
    \begin{itemize}
      \item Set overall gain to not max the actuators on the suspensions, and provide ~1 V on the input to CDS
    \end{itemize}
  \item Whitening/dewhitening design (see labbook posts)
    \begin{itemize}
      \item ADC input noise and effective number of bits (see labbook, Borja's email from 2015-08-28)
      \item Set input voltage to CDS to be ~1/10th range, i.e. 1 V.
      \item Make sure input noise from ADCs is 1/10th below the signal at all frequencies (i.e. contributes 1\% to signal)
    \end{itemize}
  \item Dark noise measurements of op-amp over long timescales (explain additional low frequency noise)
  \item Note in ``outlook'' section on how we might verify how effective the optimal filter is compared to naive addition or a ``bad'' filter. Perhaps make a TF from an open port? Choose an optimally bad filter?
  \item Quantisation noise paper also talks about maximum ADC input voltage being less than total rms signal - cite it in the relevant part
\end{itemize}

%\section{Long term drift of velocity readout}

%\section{Suspension model and control}
%ETMs are the main important ones... we assume worst case seismic noise coupling here, ignore ITM seismic noise and TFs...

%\section{Full control loop}

%\section{Performance}

%\subsection{Stability with and without sensor blending}

The presence of arm cavities within the proof-of-concept \SSM{} gives rise to challenges not previously encountered in the control of gravitational wave detectors and other experiments involving Michelson or Sagnac interferometers, and this aspect will be addressed in this chapter. In Section\,\ref{sec:velocity-control} we describe in more detail the proof-of-concept \SSM{} experiment and its control requirements. We then describe a control strategy for the \SSM{}'s differential degree of freedom based on that of Michelson designs, and demonstrate the control challenges this approach introduces. In Section\,\ref{sec:mixed-control} we present an alternative strategy which achieves adequate control of the interferometer to reach its design sensitivity over extended periods, and in Section\,\ref{sec:noise-budget} we present a noise budget of the \SSM{} using the alternative control strategy. A summary is provided in Section\,\ref{sec:summary}.

\note{Section\,\ref{c:speedmeter-intro} introduced the motivation behind the \SSMEXPT{}...}

\section{Control of the proof-of-concept experiment}

\subsection{\label{sec:ssm-dofs}Degrees of freedom}
It is obvious that the arm cavities of the \SSM{} must be held resonant in order to maintain the  stored light power required for the design sensitivity, and so these cavities represent degrees of freedom that must be controlled with active feedback. Meanwhile, the readout is insensitive to the motion of \MINT{}, since this mirror is situated at half the total round trip distance and is sensed by the counter-propagating modes at almost the same time. Other mirrors are potentially significant: the beam splitter \MSIX{} and steering mirror \MSEVEN{}, as shown in Figure\,\ref{fig:ssm-layout}. As these mirrors are situated near the start of one and the end of the other modes' round trips, a velocity dependent signal is created at the \gls{BHD} readout. To assess the importance of these optics to the interferometer's \LMINUS{} sensitivity, transfer functions from individual mirrors to the \gls{BHD} port were calculated using Optickle. The results in Figure\,\ref{fig:ssm-mirror-tfs} show that the cavity mirrors are the most important positions to control, with the arm cavity finesse enhancing the sensitivity of the \gls{BHD} to the arm cavity mirrors such that they dominate the signals from \MSIX{} and \MSEVEN{}. \MINT{}, as expected, is very weakly coupled to the \gls{BHD} port. These results have been confirmed both with Finesse and analytically \cite{Graefke2015}.

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-mirror-tfs.pdf}
  \caption{\label{fig:ssm-mirror-tfs}blah}
\end{figure}

While \MINT{} can be ruled out as a degree of freedom, the effect of \MSIX{} and \MSEVEN{} is less clear cut. To assess the impact the motion from these mirrors has on \LMINUS{} sensitivity, a calculation of the effect of seismic noise from \MSEVEN{} to the \gls{BHD} can be made. \MSIX{} need not be considered here for three reasons: the transfer function is almost identical to that of \MSEVEN{} and so we need only calculate one, the beam splitter optic will be heavier than that of \MSEVEN{} and so will couple less seismic noise, and the suspension design\textemdash a work in progress at the time of writing\textemdash is intended to have better isolation than that of \MSEVEN{}'s auxiliary suspension.

Measurements of the seismic motion present upon the ground outside the vacuum system can be propagated through a model of passive seismic isolation within the vacuum system to obtain the effective seismic motion of the tables upon which the suspensions sit. The seismic motion of \MSEVEN{} can then be calculated by multiplying this spectrum with the transfer function of the auxiliary suspension from the table to the test mass, taken from a state-space model. This seismic noise can be projected into an effective differential arm cavity motion displacement spectral density by multiplying it by the ratio of the transfer functions of \MSEVEN{} and \LMINUS{}\footnote{This is the same as multiplying the motion of \MSEVEN{} by its transfer function to the \gls{BHD} port to yield a signal in \SI{}{\watt\per\sqrthz}, and dividing by the transfer function from \LMINUS{} to the \gls{BHD} to yield an effective motion in terms of \LMINUS{}.}. This can be compared with the requirement for sensitivity of the \gls{BHD} to \LMINUS{}. Figure\,\ref{fig:m7-seismic-noise} shows that \MSEVEN{} will not introduce significant noise above \SI{100}{\hertz}, assuming a vertical to longitudinal coupling level of 1\%. From this result we can also conclude that \MSIX{} will most likely not present a problem, as this mirror is heavier than \MSEVEN{} and will likely use a suspension design with greater seismic isolation.

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-m7-seismic-noise.pdf}
  \caption{\label{fig:m7-seismic-noise}blah... this assumes coupling of 1\%, uses seismic noise propagated to tables from ground, etc. The sensitivity requirement is given only for frequencies above \SI{100}{\hertz} where the measurement of reduced radiation pressure noise will be made.}
\end{figure}

From the results in Figures \ref{fig:ssm-mirror-tfs} and \ref{fig:m7-seismic-noise} it can be concluded that there is only one significant degree of freedom to control in the interferometer in order to meet the sensitivity requirement above \SI{100}{\hertz}, where the measurement of reduced radiation pressure noise will be made. It should be noted that the desired \gls{BHD} homodyne angle depends on the path length \MELEVEN{} to \MSIXTEEN{}. This is an auxiliary control loop not considered part of the main longitudinal control strategy, and will be the subject of future work.

\subsection{Sideband frequency}
The eventual choice of sideband frequency, used to control cavity lengths using techniques such as \gls{PDH} (see Section\,\ref{sec:pdh}), will depend on a number of factors both physical and technical. For the purpose of control simulations, however, the only requirement is that the sideband frequency is not resonant within the arm cavities, in order to act as a discriminant to allow for the control of the arm cavity lengths. In practice, this means the frequency offset from the carrier must be greater than the cavity's \gls{FWHM} (see Section\,\ref{sec:cavity-fom}). For control simulations the sideband frequency was chosen to be \SI{15}{\mega\hertz}.

\subsection{\label{sec:velocity-control}Simple control strategy}
Figure\,\ref{fig:simplified-speedmeter-layout-velocity} shows a simplified optical layout with the addition of a basic control loop. The main beam splitter (BS) splits the input field towards the two triangular arm cavities where they form counter-propagating modes. One mode from each arm cavity is coupled into the other via the inter-cavity mirror \MINT{}, and the other modes recombine at the main beam splitter. Here, and for the rest of this chapter, we will consider only the cavity mirrors, the beam splitter and \MINT{}, defined as shown in Figure\,\ref{fig:simplified-speedmeter-layout-velocity}.

\begin{figure}
  \centering
  \includegraphics[width=0.5\columnwidth]{graphics/generated/from-svg/50-simplified-speedmeter-layout-velocity.pdf}
  \caption{\label{fig:simplified-speedmeter-layout-velocity}blah}
\end{figure}

As shown in Section\,\ref{sec:ssm-dofs}, each arm cavity in the \SSM{} is an independent degree of freedom and so changes to \LMINUS{} lead to frequency-dependent signals at the output port. Motion of an arm cavity mirror imparts signal sidebands upon the counter-propagating modes. These modes have different optical path lengths to the beam splitter and so the signal at the output port contains the superposition of signals representing the mirror's displacement from different points in time, which is analogous to velocity. At dc frequencies the two modes at the output port contain the same displacement information and the velocity signal is therefore zero (for a more complete description of the \SSM{}'s behaviour, see, for example, Section\,IIb of \cite{Chen2003}). Motion of \MINT{} and BS imprints common phase changes on both counter-propagating modes and are not considered degrees of freedom for signals sensed at the output port.

The error signal (\emph{readout}) representing \LMINUS{} is sensed at the main beam splitter's output port by means of a balanced homodyne detector (\gls{BHD}, see Section\,\ref{sec:bhd}) \cite{Steinlechner2015}, as shown in the shaded green area in Figure\,\ref{fig:simplified-speedmeter-layout-velocity}. The frequency dependence of the phase quadrature signal at the output port $s_{\textrm{BHD}}$ is given by the following relationship, ignoring the effect of losses (a full treatment of the effect of loss is given in ref.\,\cite{Danilishin2015}):
\begin{equation}
  \label{eq:asymdarmbhdresponse}
  s_{\textrm{BHD}} \left( \Omega \right) \propto \frac{\Omega}{ \left(\Omega^2 + \gamma_{\textrm{arm}}^2 \right)} L_{\left(-\right)},
\end{equation}
for angular frequency $\Omega$ and with arm cavity half-bandwidth $\gamma_{\textrm{arm}}$ defined to be:
\begin{equation}
  \gamma_{\textrm{arm}} = \frac{c_{0} T_{\textrm{ITM}}}{4 L_{\textrm{RT}}},
\end{equation}
for speed of light $c_{0}$, arm cavity input test mass (\gls{ITM}) power transmissivity $T_{\textrm{ITM}}$ and arm cavity round-trip length $L_{\textrm{RT}}$.
   
Other terms in the response function dependent upon mirror mass, laser power and mechanical modes are not frequency dependent. Note that for $\Omega \ll \gamma_{\textrm{arm}}$ the response is proportional to frequency, vanishing towards dc, as described above and shown in Figure\,\ref{fig:bhd-response}.

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-bhd-response.pdf}
  \caption{\label{fig:bhd-response}blah}
\end{figure}

In order to maintain peak \gls{BHD} sensitivity to \LMINUS{} and therefore gravitational waves, the positions of the cavity mirrors are controlled using \emph{linear inverting feedback}, where an error signal is extracted and applied through a control law to cavity mirror actuators. In the experiment, voice coils and plate capacitor electrostatic drives (\glspl{ESD}) \cite{Wittel2015} are used to actuate on the position of the end test masses within each cavity. This feedback maintains the interferometer close to its operating point within the bandwidth of the controller. In order to achieve the required stability, the relative position of the cavity mirrors must be controlled to within \SI{3.5e-13}{\meter} rms (see Section,\ref{sec:ssm-required-control}).
   
% For phase noise calculation, see p56 of Lisa Barsotti's thesis
% Or p53 of Rana's thesis
% Or Advanced Virgo design study

\subsection{\label{sec:ssm-required-control}Required controller precision}

The noise present within the interferometer will produce an unintended \emph{dark-fringe offset} at the output port of the \SSM{}. Using the parameters listed in Appendix\,\ref{app:parameters} with the relation linking laser frequency fluctuations $\Delta f$ and cavity length fluctuations $\Delta L_{\left(-\right)}$,

\begin{equation}
  \frac{\Delta L_{\left(-\right)}}{L_{\textrm{RT}}} = \frac{\Delta f}{f_{0}},
\end{equation}
with $f_{0} = \frac{c_{0}}{\lambda_{0}}$ representing the laser frequency, the requirement for the \SSM{} is that the residual motion of the mirrors must be less than \SI{3.5e-13}{\meter}. This uses the assumption that the frequency fluctuations $\Delta f$ fall within \SI{1}{\percent} of the arm cavity full-width half-maxima\textemdash a common heuristic method used to ensure that technical noise sources do not couple strongly to the gravitational wave channel.

As shown in ref. \cite{Danilishin2015}, main beam splitter asymmetries introduce common arm cavity mode coupling at the output port, which leads to further unintended dark fringe offset, and so the real requirement is likely to be more stringent. The above requirement, however, is sufficient to highlight the problem of velocity-only control as shown in Section\,\ref{sec:velocity-control}.

%     \caption{\ssm{} optical layout and extraction of the BHD signal sensitive to the arm cavity differential mode. Figure\,(a) contains a simplified layout of the experiment. Light from the input optics (not shown) is incident upon the main beam splitter. The shaded green area shows the BHD extracting the signal from the main beam splitter's output port (see Section\,\ref{sec:bhd}). The triangular arm cavities are shown in the shaded grey area, and mirror \MINT{} couples light between them. Two additional photodetectors (shaded blue area) are present behind \MINT{} for individual arm cavity signal extraction. The sensing and feedback signal paths are described in detail in Sections\,\ref{sec:velocity-control} and \ref{sec:mixed-control}. Figure\,(b) contains the frequency response of the BHD to \LINUS{}, simulated numerically with \emph{Optickle}. Figure\,(c) contains a simplified version of the intended balanced homodyne detector readout electronics. The difference current from two matched, high quantum efficiency photodetectors is amplified via a transimpedance op-amp stage, with this signal representing the differential velocity of the arm cavity mirrors (see Equation\,\ref{eq:asymdarmbhdresponse}).}
%   \end{figure}
% 
\subsection{\label{sec:bhd}Balanced homodyne detection}
     
The \gls{BHD} consists of two high quantum-efficiency photodetectors sensing the reflected and transmitted fields from the \gls{BHD}'s beam splitter. A local oscillator is incident upon the \gls{BHD}'s beam splitter to provide gain for the velocity information encoded within the light from the main beam splitter. The difference current is converted to a voltage by an op-amp with transimpadance resistor \RT{} before being sent to the data acquisition system (\gls{DAQ}) \note{explain why this transimpedance was chosen}. An example circuit for the balanced homodyne detector is shown in Figure\,\ref{fig:bhd-electronics}. The op-amp introduces its own noise to the output, though a well-chosen op-amp will possess noise significantly lower than the signal representing \LMINUS{} in the intended measurement band. In order for an op-amp to contribute less than \SI{1}{\percent} of the uncorrelated noise in the measurement, its noise must be at least a factor of \SI{10}{} below the dominating noise source in the measurement band.

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-tikz/50-bhd-electronics.pdf}
  \caption{\label{fig:bhd-electronics}blah}
\end{figure}

Op-amps used for control in audio-band interferometry typically possess a noise power spectrum inversely proportional to frequency (so-called \emph{flicker noise} \cite[Section\,11.2.3]{Gray2009}) in the low audio band. As the \gls{BHD} error signal is dependent upon the time derivative of the mirror positions, however, there will necessarily be frequencies at which the op-amp noise will dominate the \gls{BHD} error signal. This makes control of slow drifts of the arm cavity mirror positions impossible with the velocity readout, despite the op-amp being well-chosen for a measurement band above \SI{100}{\hertz}. This control problem with relation to the proof-of-concept experiment will be quantified in the following subsections.

\subsection{\label{sec:op-amp-noise}Op-amp noise}
     
%       \subfigure[]{\includegraphics[width=\columnwidth]{graphics/dynamic/op-amp-noise-time-series.pdf}\label{fig:op-amp-noise-time-series}}
%       \subfigure[]{\includegraphics[width=\columnwidth]{graphics/dynamic/op-amp-noise-spectrum.pdf}\label{fig:op-amp-noise-spectrum}}
%       \caption{Balanced homodyne detector op-amp noise measurements. The electronic schematic is shown in (a). The time series over a period of 16 days is shown in (b) for the op-amp noise at $\textrm{N}_{\textrm{1}}$ (blue) along with the DAQ noise for an empty channel (green). Temperature measurements (black) are shown on the second (right) vertical axis. A drift in the op-amp noise of around \SI{7}{\milli\volt} is visible in the first week. The spectral density in (c) shows the data in (b) plotted in the frequency domain using a Fourier transform with windows of \SI{e4}{\second}. The op-amp and DAQ noise spectra are shown along with modelled op-amp and resistor noise sources projected into the same measurement point. The op-amp noise resembles the modelled total noise (red) at frequencies above \SI{1}{\hertz}.}
%     \end{figure}

To measure the effect of a suitable op-amp's noise at low frequency, the output from an applicable BHD circuit was investigated. The circuit shown in Figure\,\ref{fig:bhd-noise-electronics} was housed within a dark enclosure to minimise photocurrent, with one of the two op-amps within a Texas Instruments\textsuperscript{\textregistered} OPA2227 integrated circuit being used to amplify the noise from the other by a factor of \SI{100}{}, to a level detectable by the DAQ. This op-amp is suitable for the BHD circuit shown in Figure\,\ref{fig:bhd-electronics} given the intended measurement band around a few hundreds of \SI{}{\hertz} \cite{Graef2014}.

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-tikz/50-bhd-noise-electronics.pdf}
  \caption{\label{fig:bhd-noise-electronics}blah}
\end{figure}

The time series in Figure\,\ref{fig:op-amp-noise-time-series} shows a drift in the measured op-amp noise over the course of \SI{16}{} days. An open channel on the DAQ was measured concurrently. A Fourier transform of the measured op-amp noise time series (Figure\,\ref{fig:op-amp-noise-spectrum}) shows a combination of flicker noise and an additional slope possibly due to resistor current noise below around \SI{1}{\hertz} \cite{Seifert2009}. DAQ noise dominates above \SI{4}{\hertz}. The ``Model (total)'' spectral density in Figure\,\ref{fig:op-amp-noise-spectrum} show the contributions to the measurements from the first op-amp $\textrm{N}_{1}$'s current and voltage noise and the Johnson-Nyquist noise of its transimpedance resistor $\textrm{R}_{\textrm{T}}$. This spectral density additionally contains the measured open channel noise summed in quadrature to show the agreement it has with the measurements down to around \SI{1}{\hertz}.

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-op-amp-noise-time-series.pdf}
  \caption{\label{fig:op-amp-noise-time-series}blah}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-op-amp-noise-spectrum.pdf}
  \caption{\label{fig:op-amp-noise-spectrum}blah}
\end{figure}

The op-amp noise drift produces an offset upon the \gls{BHD} error signal which is to be fed back to the cavity mirror actuators, and thus op-amp noise directly contributes to cavity mirror displacement noise, affecting the experiment's sensitivity to the arm cavity differential mode. Since the signal measured at the \gls{BHD} represents cavity mirror velocity, it must necessarily drop below the noise at low frequencies where the velocity tends to zero.

\subsection{Technical noise}

\subsubsection{Analogue to digital converters}
The conversion of analogue signals to digital for use by \gls{CDS} involves the use of \glspl{ADC}. Noise in the \gls{ADC} arises from quantisation error $\epsilon_{\text{ADC}}$, which is the mismatch between the underlying signal input and the level determined by the \gls{ADC} \cite{Allen1997}. An \gls{ADC}'s job is to take an analogue signal of some voltage and convert it into a corresponding binary word proportional to that input. The fastest \glspl{ADC} work by splitting the input signal into copies and comparing each copy against an increasing threshold voltage\footnote{This is called a ``parallel'' \gls{ADC}, though there exist many other forms such as ``successive approximation'', ``voltage-to-frequency'', ``integration'' and ``delta-sigma''. A good overview is given in \cite{Horowitz2015}.}. Initially ignoring additional technical complexity, we can imagine the thresholds of the \gls{ADC} to represent bits of a binary word. The first threshold will check if the input is above or below \SI{1}{\volt}, and output a corresponding high or low signal at that bit location. Subsequent thresholds check for \SI{2}{\volt}, \SI{4}{\volt} and so on. With this simple picture the most obvious flaw is that this system can only determine integer voltage levels, and so the quantisation error is \SI{0.5}{\volt}. In reality, however, input signals are stationary random processes and oscillate between thresholds; in effect they are self-dithered. By averaging over successive cycles, the \gls{ADC} can make a better approximation of the underlying signal, reducing the quantisation error to the interval $\epsilon_{\text{ADC}} \in \left( \frac{-\Delta}{2}, \frac{\Delta}{2} \right]$, where $\Delta$ is the smallest representable voltage level of the \gls{ADC}:
\begin{equation}
  \begin{split}
    \Delta &= \frac{V_{\text{max}} - V_{\text{min}}}{2^{b}} \\
           &= \frac{V_{\text{range}}}{2^{b}}.
  \end{split}
\end{equation}

Quantisation noise depends on the noise produced by the components that make up an \gls{ADC}'s threshold sensors. In the case of \gls{CDS}, the effective number of bits\footnote{One might decide to purchase an \gls{ADC} based merely upon its number of bits, but this is not a good guide for determining its sensitivity. A 24-bit \gls{ADC} is no better than a 16-bit \gls{ADC} if the first 8 bits are noise. A more useful figure of merit is the \gls{ENOB}.} (\gls{ENOB}) is $b = 13.9$, corresponding to a noise level of \SI{1.8e-6}{\volt\per\sqrthz} using the relation:
\begin{equation}
  \epsilon_{\text{ADC}} = \frac{V_{\text{range}}}{2^b \sqrt{12 f_{N}}},
\end{equation}
where $f_{N}$ is the Nyquist frequency. This noise floor is flat across much of the bandwidth of \gls{CDS}, as it is determined by the noise of op-amps chosen for low noise in the audio band.

\subsubsection{Digital to analogue converters}
From the digital to the analogue domain, the same process happens in reverse with \glspl{DAC}. This time, quantisation noise arises directly from the inability of the \gls{DAC} to faithfully reconstruct the digital signal without adding noise. With the \gls{CDS} system, the \glspl{ADC} and \glspl{DAC} are well matched and both possess the same noise floor.

\subsubsection{Whitening and dewhitening filters}
The signals sensed by the interferometer's photodetectors contain large components at low frequencies arising from seismic noise, and small components at higher frequencies where the measurement of radiation pressure and shot noise can be made. The \gls{ADC}'s input range of \SI{\pm10}{\volt} and its noise \SI{1.8e-6}{\volt\per\sqrthz} lead to a dynamic range $\text{D}$ of:
\begin{equation}
  \begin{split}
    \text{D} &= 20 \log_{10} \left( \frac{V_{\text{max}}}{\epsilon_{\text{ADC}}} \right) \\
             &= \SI{134.9}{\deci\bel}.
  \end{split}
\end{equation}
Well chosen signal amplification should result in an \gls{RMS} signal of less than $\frac{1}{10} V_{\text{max}}$, giving headroom to the sensors for larger, less frequent noise transients to be detected without clipping while still allowing small signal detection. As the signal from the interferometer is shaped approximately inversely to frequency, signals at \SI{1}{\kilo\hertz} are typically many orders of magnitude smaller than those of seismic noise at a few \SI{}{\hertz}. This means that signals of the level of quantum noise are sometimes lost in the noise from the \glspl{ADC} and \glspl{DAC}. To avoid this problem, a technique called \emph{whitening} can be used. This involves applying a filter to the desired input or output signal in order to increase certain frequency components of a signal.

\note{discuss whitening/dewhitening requirements}

\subsubsection{Aliasing and imaging}

A consequence of the Nyquist sampling theorem is that \gls{AC} signal content can be exactly reconstructed by a sampler if and only if the signal power above the Nyquist frequency is zero. Non-zero signal at frequencies $f > f_{\text{N}}$ will enter the band of the sampler every \checkme{$\frac{f}{f_{\text{N}}}$} cycles and appear on top of the real signal content in that band. To prevent this occurrence, anti-aliasing filters can be utilised to aggressively suppress higher frequency content using analogue electronics before the signal is sampled by the \gls{ADC}. Similarly, the output from a \gls{DAC} can be propagated through an anti-imaging filter to prevent the \gls{DAC}'s finite sample rate from creating higher frequency copies of in-band signal content.

With \gls{CDS}, the sample rate is \SI{65536}{\hertz}, and so the Nyquist frequency is \SI{32768}{\hertz}, and the anti-aliasing and anti-imaging filters have cut-off frequency \SI{9}{\kilo\hertz} to ensure that frequency content near the Nyquist frequency is practically zero.

\note{TF of AA/AI filters}

\subsubsection{Suspension gain hierarchy}

\note{Discuss violin modes too}

\subsubsection{Interferometer compensation}

\subsubsection{Loop gain}

\subsection{Control loop with velocity sensing}

A control loop schematic using the calculations, filters and servos presented in this section is shown in Figure\,\ref{fig:ssm-control-loop-velocity}. The items contained within the grey box are implemented in software as part of the LIGO control and data system \cite{Bork2010}. The lower section contains the blocks which exist in the analogue domain.

\begin{figure}
  \includegraphics[width=\textwidth]{graphics/generated/from-svg/50-speedmeter-control-loop-velocity.pdf}
  \caption{\label{fig:ssm-control-loop-velocity}Simple \SSM{} control loop model. The interferometer plant produces signals representing the probes in the interferometer, and sensing noise is added before the signals are sent to the digital controller, shown in the grey box. Within the controller, the error signal representing \LMINUS{} is fed through a series of filters and sent to the test mass actuators, with the addition of \gls{DAC} noise. The suspension blocks transform the feedback signals into test mass displacements, and seismic, coating Brownian and suspension thermal noise is injected at the input to the interferometer plant. \note{ADD AI FILTERS}}
\end{figure}

\subsection{Noise projection}

To reach the desired sensitivity of the interferometer it is crucial to understand the noise characteristics associated with the sensing and control apparatus employed in the experiment. Individual noise sources, for example arising from the \gls{BHD} op-amp electronics, can be projected into units of differential displacement-equivalent noise using the linear projection technique \cite{Smith2006}. The sources of noise can be logically separated into two broad categories: \emph{sensing noise} and \emph{displacement noise}. Both sources of noise are fed back to the test masses because in practice it is not possible for the controller to distinguish them.

Sources of sensing noise are associated with the readout of the variable of interest\textemdash in the case of the \SSM{} the positions of the test masses' surfaces\textemdash but do not directly influence the variable of interest in an open loop measurement. Sources of sensing noise include quantum shot noise, electronic noise including op-amp noise as modelled in Section\,\ref{sec:op-amp-noise} and digitisation noise due to the analogue-to-digital converter (\gls{ADC}).

Displacement noise sources directly influence the positions of the test mass surfaces being measured by the interferometer and are therefore transformed by the dynamics of the test masses \cite{Danilishin2015}. As the readout variable in the \gls{BHD} is the time derivative of position, the control system measures and actively suppresses these noise sources. Significant sources of displacement noise in the \SSM{} experiment are quantum radiation pressure noise, seismic noise, suspension thermal noise \cite{Hammond2012} and coating brownian noise arising from the dielectric coatings present upon the cavity mirrors \cite{Harry2002}.

The noise projection for \LMINUS{}, calculated using the numerical optomechanical simulation tool \emph{Optickle} \cite{Evans2012} (see Appendix\,\ref{sec:optickle-sim}) and the control noise modelling tool \emph{SimulinkNb} \cite{SimulinkNb}, is shown in Figure\,\ref{fig:readout-noise-velocity}. The root-mean-square (\gls{RMS}) differential displacement this creates is shown in Figure\,\ref{fig:readout-noise-velocity-rms} as a function of time. It shows that, as the interferometer is held at its operating point, over a period of several hours the expected drift is large enough for the cavities to become uncontrollable (see Appendix\,\ref{sec:ssm-required-control}).

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-readout-noise-velocity.pdf}
  \caption{\label{fig:readout-noise-velocity}blah}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-readout-noise-velocity-rms.pdf}
  \caption{\label{fig:readout-noise-velocity-rms}blah}
\end{figure}

%       \caption{Noise associated with the velocity readout scheme. The spectral density in (a) shows the noise associated with the readout of the signal representing \LMINUS{} using the BHD. The significant noise sources associated with sensing and feedback are shown. Lab measurements of seismic noise have been made down to \SI{0.3}{\hertz}, and the assumption has been made that the noise is sharply suppressed below the microseism at \SI{0.1}{\hertz}. Below \SI{20}{\milli\hertz} the dominating readout noise is due to the op-amp electronics. The time series in (b) shows the root-mean-square arm cavity mirror motion due to readout noise over one day. Beyond a few hours the motion is greater than the control requirement presented in Section,\ref{sec:ssm-required-control}}
%     \end{figure}

Although for sensing noise we only consider electronic and shot noise, in the experiment there will be other contributing forms of time-varying offset present upon the \gls{BHD} error signal:
\begin{itemize}
  \item residual local oscillator light due to temperature-driven imbalances in the \gls{BHD} beam splitting ratio and photodetector quantum efficiencies;
  \item common mode arm cavity motion due to imbalanced beam splitting at the main beam splitter \cite{Danilishin2015};
  \item thermoelectric potentials and op-amp drift in pre-amplifier and whitening electronics;
  \item any other time-varying effects.
\end{itemize}
As such, the estimated rms displacement shown in Figure\,\ref{fig:readout-noise-velocity-rms} represents a ``best case'' scenario where the op-amp's electronic noise is the dominant effect at low frequencies, and this drift becomes unacceptably large after a few hours. To allow for long term cavity stability it is essential for the error signal to contain a signal significantly above the electronic noise at low frequencies. In the next section we present a strategy for obtaining an error signal of suitable magnitude across the entire control bandwidth.
 
\section{\label{sec:mixed-control}Velocity-displacement control}
   
Light from each counter-propagating mode is incident upon the inter-cavity steering mirror \MINT{}, and as such this is a natural port in which to separate the modes and sense the motion of each arm cavity (see the shaded blue region of Figure\,\ref{fig:simplified-speedmeter-layout-mixed}). Using RF modulation, for instance \emph{via} the Pound-Drever-Hall (\gls{PDH}) technique \cite{Drever1983}, it is possible to obtain a displacement error signal for each cavity that, unlike the velocity signal from the \gls{BHD}, has flat response at \gls{DC}, with a similar cavity pole frequency (see Figure\,\ref{fig:pdh-response}). The individual cavity \gls{PDH} signals can be mixed to obtain a measurement of \LMINUS{}, and the frequency dependence of the signal $s_{\textrm{PDH}}$ is, following ref.\,\cite{Kimble2001}, given by:
\begin{equation}
  \label{eq:m9darmpdhresponse}
  s_{\textrm{PDH}} \left( \Omega \right) \propto \sqrt{\frac{\gamma_{\textrm{arm}}}{\left(\Omega^2 + \gamma_{\textrm{arm}}^2 \right)}} L_{\left(-\right)},
\end{equation}
ignoring again the effect of losses and constant terms as with Equation \ref{eq:asymdarmbhdresponse}. Note that for $\Omega \ll \gamma_{\textrm{arm}}$, the response is flat as expected for a displacement measurement and as such the PDH readout offers a suitable signal to sense \LMINUS{} at low frequencies.

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-svg/50-simplified-speedmeter-layout-mixed.pdf}
  \caption{\label{fig:simplified-speedmeter-layout-mixed}blah}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-pdh-response.pdf}
  \caption{\label{fig:pdh-response}blah}
\end{figure}

\subsection{\label{sec:combined-filter}Combined filter}

The separate velocity and displacement readouts contain the same fundamental information about the position of the mirrors, albeit with different response functions. We can express the signal at output field $i$ as a function of the $k^{\textrm{th}}$ mode of motion, $\hat{o}_{\textrm{k,i}} \left( \Omega \right)$, as \cite{Kimble2001}:
\begin{equation}
  \label{eq:readout-signals}
  \hat{o}_{\textrm{k,i}} \left( \Omega \right) = L_{\textrm{k}}\left(\Omega\right) + \frac{\hat{n}_{\textrm{i}} \left( \Omega \right)}{R_{\textrm{k,i}} \left( \Omega \right)}
\end{equation}
where $L_{\textrm{k}}$ is the position of mode $k$, $\hat{n}_{\textrm{i}} \left( \Omega \right)$ is the noise at field $i$ and $R_{\textrm{k,i}} \left( \Omega \right)$ is the optomechanical transfer function of mode $k$ to field $i$. The definition of a field in this case refers to that of a single signal sideband, $\Omega$. The total time domain signal on a perfect sensor due to the $k^{\textrm{th}}$ mode at the location of the output field will see a combination of the upper and lower signal sidebands:
\begin{equation}
  \hat{o}_{\textrm{k,i}} \left( t \right) = \int_{0}^{\infty} \frac{\textrm{d} \Omega}{2 \pi} \left( \hat{o}_{\textrm{k,i}} \left( \omega_{0} + \Omega \right) + \hat{o}_{\textrm{k,i}}^\dag \left( \omega_{0} - \Omega \right) \right) e^{-i \Omega t},
\end{equation}
where $\omega_{0}$ is the angular frequency of the carrier.

Classical noise sources associated with the test mass modes, such as thermal and seismic noise, are implicit in $L$. The excess noise at each readout port is therefore due to $\hat{n}_{\textrm{i}}$, the quantum vacuum entering at open ports within the interferometer. The presence of such vacuum noise limits the sensitivity of the interferometer in the measurement band. For this reason the reflectivity of \MINT{} must be chosen to be close to unity, therefore only a small amount of light is available to the displacement readout for use as a low frequency error signal.

By considering the response and noise characteristics of the \gls{BHD} and \gls{PDH} readouts it is possible to combine them with a filter in order to maximise the interferometer's sensitivity across the full intended frequency range. A desirable crossover frequency for this filter is constrained from below by the signal-to-noise ratio of the \gls{BHD} and from above by the noise introduced onto the feedback signal by the \gls{PDH} readout. There is a \SI{90}{\degree} phase difference between the displacement and velocity signals at low frequencies and as such simply combining the \gls{PDH} and \gls{BHD} signals with dc gain produces a filter with a stable crossover that can be used as an error signal. The feedback of this combined filter output allows the displacement signal from the \gls{PDH} to control the cavity mirrors at low frequencies where it is stronger, while letting the \gls{BHD} signal provide feedback at higher frequencies where it yields the greatest response. The differential displacement-equivalent noise projection for a suitable combined filter is shown in Figure\,\ref{fig:readout-noise-mixed}. The rms displacement in Figure\,\ref{fig:readout-noise-mixed-rms} shows a clear reduction in residual displacement with respect to the feedback using only the velocity signal.

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-readout-noise-mixed.pdf}
  \caption{\label{fig:readout-noise-mixed}blah}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-readout-noise-mixed-rms.pdf}
  \caption{\label{fig:readout-noise-mixed-rms}blah}
\end{figure}

%       \caption{Combined filter readout noise. The spectral density in (a) shows the noise due to sensing and control using a combination of velocity and displacement readout schemes. The total noise in the velocity-only scheme is shown for reference. The mixing of displacement information into the feedback signal at low frequencies leads to greatly reduced displacement noise. The time series in (b) shows the root-mean-square differential displacement the combined filter causes. The combined filter provides a displacement reference at low frequencies and allows control of the \ssm{} for significantly longer periods than with only a velocity readout.}
%     \end{figure}

\subsection{\label{sec:optimal-filter}Optimal filter}

By considering cross-correlations in the quantum noise at the \gls{BHD} and \gls{PDH} readouts, it is possible to produce an optimal filter with which to combine the two in such a way as to minimise the total noise spectral density. The noise at each readout is the sum of the quantum noise inputs at open ports propagated through the interferometer with appropriate transfer functions, so we can rewrite $\hat{n}_{\textrm{i}}$ in Equation\,\ref{eq:readout-signals} in terms of the quantum noise amplitudes $\hat{q}_{\textrm{m}}$ entering at $N_{\textrm{p}}$ open ports:
\begin{equation}
  \hat{n}_{\textrm{i}} \left( \Omega \right) = \sum_{m=1}^{N_{\textrm{p}}} M^{\textrm{ff}}_{\textrm{m,i}}\left( \Omega \right) \hat{q}_{\textrm{m}} \left( \Omega \right),
\end{equation}
where $M^{\textrm{ff}}_{\textrm{m,i}}\left( \Omega \right)$ represents the transfer function between input field $m$ and output field $i$ for signal sideband $\Omega$. The cross-correlation spectral density for unity noise at the $i^{\textrm{th}}$ and $j^{\textrm{th}}$ output channels, for the $k^{\textrm{th}}$ mode, is then \cite{Danilishin2012}:
\begin{equation}
  \begin{split}
    S_{\textrm{k,\,ij}}(\Omega) = \sum_{m=1}^{N_{\textrm{p}}} \dfrac{\left[M^{\textrm{ff\,*}}_{\textrm{m,\,i}}(\Omega)M^{\textrm{ff}}_{\textrm{m,\,j}}(\Omega)+M^{\textrm{ff\,*}}_{\textrm{m,\,j}}(-\Omega)M^{\textrm{ff}}_{\textrm{m,\,i}}(-\Omega)\right]}{[R^*_{\textrm{k,\,i}}(\Omega)+R_{\textrm{k,\,i}}(-\Omega)][R_{\textrm{k,\,j}}(\Omega)+R^*_{\textrm{k,\,j}}(-\Omega)]}.
  \end{split}
\end{equation}
This reduces to the following form for noise entering the same port in which it exits:
\begin{equation}
  S_{i,i} = \frac{1}{2} \frac{\left| M^{\textrm{ff}}_{i,i}\left( \Omega \right) \right|^{2} + \left| M^{\textrm{ff}*}_{i,i}\left( -\Omega \right) \right|^{2}}{\left(\left| R^{ }_{k,i}\left( \Omega \right) \right| + \left| R^*_{k,i}\left(-\Omega\right)\right|\right)^{2}}.
\end{equation}
Assuming a filter $\alpha\left( \Omega \right)$ combines the BHD ($i = 1$) and PDH ($i = 2$) fields, its output for $L_{\textrm{k}}$ would be:
\begin{equation}
  \begin{split}
    \hat{o}_{\textrm{k,combined}} \left( \Omega \right) &= \alpha\left( \Omega \right) \hat{o}_{\textrm{k,1}} \left( \Omega \right) + \left( 1 - \alpha\left( \Omega \right) \right) \hat{o}_{\textrm{k,2}} \left( \Omega \right) \\
    &= \left( \alpha\left( \Omega \right) L_{\textrm{k}} \left( \Omega \right) + \left(1 - \alpha\left( \Omega \right) \right) L_{\textrm{k}} \left( \Omega \right) \right) \\
    &+ \frac{\alpha\left( \Omega \right) \hat{n}_{\textrm{1}}}{R_{\textrm{k,1}}\left(\Omega\right)} + \frac{\left( 1 - \alpha\left( \Omega \right) \right) \hat{n}_{\textrm{2}}}{R_{\textrm{k,2}} \left(\Omega\right)}.
  \end{split}
\end{equation}      
The corresponding total noise power spectral density of the combined readout is then:
\begin{equation}
  \label{eq:readout-spectral-density}
  \begin{split}
    S_{\textrm{readout}} &= \left| \alpha \right|^{2} S_{n_{1},n_{1}} + \left| 1 - \alpha \right|^{2} S_{n_{2},n_{2}} \\
    &+ \Re \left[ \alpha^* \left(1 - \alpha \right) S_{n_{1},n_{2}} \right] \\
    &+ \Re \left[ \alpha^* \left(1 - \alpha \right) S_{n_{2},n_{1}} \right],
  \end{split}
\end{equation}
where $S_{n_{1},n_{1}}$ is the noise power spectral density at the \gls{BHD} port due to vacuum entering at the \gls{BHD} port, $S_{n_{2},n_{2}}$ is the noise power spectral density at the \gls{PDH} port due to vacuum entering at the \gls{PDH} port, and $S_{n_{1},n_{2}}$ and $S_{n_{2},n_{1}}$ are the noise power spectral densities for noise entering at one port and exiting at the other. The optimal filter $\alpha_{\textrm{opt}}$ can be determined by minimising Equation\,\ref{eq:readout-spectral-density} over $\alpha$:
\begin{equation}
  \label{eq:optimal-filter}
  \alpha_{\textrm{opt}} = \frac{S_{n_{1},n_{2}} - S^*_{n_{1},n_{2}}}{S_{n_{1},n_{1}} + S_{n_{2},n_{2}} - \Re \left[ S_{n_{1},n_{2}} \right] - \Re \left[ S_{n_{2},n_{1}} \right]}.
\end{equation}
The reflectivity of \MINT{} is implicit in both the field-to-field and mode-to-field transfer matrices for each signal sideband, $\mathbf{M}^{\textrm{ff}}$ and $\mathbf{R}$, respectively, and as such $\alpha_{\textrm{opt}}$ depends on the value of \MINT{}.

The matrices $\mathbf{M}^{\textrm{ff}}$ and $\mathbf{R}$ are not calculated in Optickle by default, and so some modifications to the code were necessary (see Appendix\,\ref{sec:optickle-field-tfs}). The effect of \MINT{}'s reflectivity on $\alpha_{\textrm{opt}}$ is shown in Figure\,\ref{fig:optimal-filters}. Note that, because it is calculated with precomputed spectral densities and not tested for stability, the filter predicted by Equation\,\ref{eq:optimal-filter} is not necessarily realisable. A causal Wiener filter has previously been calculated for single-readout interferometers \cite{MuellerEbhardt2009, Miao2010}, but a similar calculation for more than one readout has not yet been investigated. While Equation\,\ref{eq:optimal-filter} enables the lowest noise spectral density for the measurement of the motion of the differential mode of the \SSM{}, in the case of the proof-of-concept experiment simply combining the \gls{BHD} and \gls{PDH} signals with \gls{DC} gain, as suggested in Section\,\ref{sec:combined-filter}, is close to optimal. The difference in response gradients above the cavity pole frequency prevents the \gls{PDH} signal from contaminating the \gls{QND} effect in the intended measurement band. The calculation presented in this section, however, is a general solution for any system with multiple readouts for a single variable and may prove useful for future gravitational wave detectors utilising \gls{QND} techniques.
\begin{figure}
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-optimal-filters.pdf}
  \caption{\label{fig:optimal-filters}Optimal filters to combine the BHD and PDH signals for different values of \MINT{} reflectivity. The red, yellow and green curves are the coefficients to be applied to the BHD signal with respect to the PDH signal before the two are combined, for different \MINT{} (power) reflectivities. The black, dashed curve is the (unity) coefficient to be applied to the PDH signal. For all values of \MINT{} shown, the optimal combination involves suppressing the BHD signal with respect to the PDH at frequencies below around \SI{1}{\kilo\hertz}; equivalently, the PDH signal must be amplified with respect to the BHD signal in the same band, an example of which is presented in Section\,\ref{sec:combined-filter}.}
\end{figure}

\section{\label{ssm-control-scheme}Full control scheme}
The intended control loop schematic for the proof-of-concept experiment is shown in Figure\,\ref{fig:ssm-control-loop-mixed}. The ``fiducial'' section is well defined and is based on existing DAQ hardware and software, an implementation of the LIGO control and data system \cite{Bork2010}. The bottom section contains the blocks which have been modelled during the course of this work.

\begin{figure}
  \includegraphics[width=\textwidth]{graphics/generated/from-svg/50-speedmeter-control-loop-mixed.pdf}
  \caption{\label{fig:ssm-control-loop-mixed}\SSM{} control loop model. The interferometer plant produces signals representing the probes in the interferometer, and sensing noise is added before the signals are sent to the digital controller. Within the controller, the interferometer readouts are combined into an error signal representing \LMINUS{}. The error signal is fed through a series of filters and sent to the test mass actuators, with the addition of DAC noise. The suspension blocks transform the feedback signals into test mass displacements, and seismic, coating Brownian and suspension thermal noise is injected at the input to the interferometer plant.}
\end{figure}

All blocks shown are frequency dependent matrices with one or more inputs and outputs. The green blocks represent simple filters possessing single inputs and outputs. Each filter multiplies its input by a transfer function in order to calculate its output. The blue blocks represent transfer matrices, which are multiple-input and multiple-output filters. The grey triangles represent dc gain, and are equivalent to simple filters without frequency-dependent response. The undulating orange arrows represent noise injection.

\subsection{Sensing}

The outputs from the interferometer block are probe signals modelled by Optickle for a given set of test mass displacement inputs. Quantum vacuum noise, also modelled by Optickle, is injected onto these signals. The BHD signal is calculated by taking the difference between the two homodyne probe signals, BHD A and BHD B. Each signal is passed through a quantum efficiency gain stage to represent the conversion of light power into photocurrent by the photodetector, and then through a transimpedance gain stage to convert the photocurrent into a voltage. The PDH signals receive additional gain due to RF demodulation. At this point, the signals are sent to the DAQ. Whitening filters ensure the signals are far above the noise of the ADCs. The noise associated with the conversion process is injected at this point. To prevent aliasing due to the ADC sample frequency, \SI{65536}{\hertz}, filters are employed to suppress signal content above around \SI{10}{\kilo\hertz}. The conversion from volts to digital counts within the ADCs is represented by a gain block for each channel.

\subsubsection{Photodiode quantum efficiency}
\note{A PD has quantum efficiency... state equation for voltage in terms of photocurrent and eta... discuss why we use high QE PDs for the BHD and not for the PDH...}

\subsubsection{Photodetector readout}
\note{Transimpedance chosen to match current and voltage noise... whitening filters chosen to boost signal above noise (see Ken's emails and labbook posts)}

\subsection{Control}

In the digital domain, dewhitening filters reverse the effect of the whitening filters to recover the original signals. At this point, the arm cavity displacement signal can be constructed by taking the difference between the individual PDH signals. This signal is then combined with the BHD's velocity signal via readout gain stages (as presented in Section\,\ref{sec:combined-filter}) which set the crossover frequency between velocity and displacement measurements. If an optimal filter were to be employed as shown in Section\,\ref{sec:optimal-filter}, these gain blocks would be filters.

The unity gain frequency of the feedback system is set by the loop gain block. A filter is also present here to compensate the feedback signals for the shape of the interferometer's frequency response. The output from this filter is split into two signals to be applied differentially to ETMs $\textrm{M}_{\textrm{A}}^{\textrm{ETM 1}}$ and $\textrm{M}_{\textrm{B}}^{\textrm{ETM 1}}$, as shown in Figure\,\ref{fig:simplified-speedmeter-layout}. Actuator range can be further extended by splitting this feedback between the other mirrors in each cavity, but this is not modelled in this work. The signal applied to the $\textrm{M}_{\textrm{B}}^{\textrm{ETM 1}}$ suspension system is inverted in order to move the test masses differentially.

\subsubsection{Interferometer compensation}
\note{Basically whitening for the interferometer shape}

\subsection{Driving}

Each test mass's correction signal is passed through a set of driving filters representing the dynamics of each actuator. The ETMs are suspended from triple pendulums to provide sufficient isolation from seismic noise within the measurement band. In order to provide corrective actuation upon the test masses, voice coil actuators are present on the suspension stage immediately above each test mass in addition to (unsuspended) ESDs situated behind each test mass. The ESDs are sufficiently insensitive to seismic motion transverse to the test mass that they need not be suspended \cite{Wittel2015}. The ESDs' ability to actuate directly upon the test masses makes them suitable for high frequency corrections whereas the extensive range of the voice coils makes them suitable for the suppression of the dominating seismic noise below the measurement band.

Each correction signal is passed through a gain hierarchy to split the feedback between the voice coil and ESD actuators. The open loop transfer functions for each actuator are shown in Figure\,\ref{fig:suspension-crossover}. The crossover frequency between the two actuators is \SI{18}{\hertz}.

\begin{figure}
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-etm-suspension-tfs.pdf}
  \caption{\label{fig:suspension-crossover}Simulated proof-of-principle \SSM{} \gls{ETM} suspension open loop transfer functions showing the difference in gain between the two test mass actuators. The voice coils provide extensive actuation range but are suppressed at high frequencies by the final stage pendulum. The \gls{ESD} actuates directly upon the test mass and is therefore capable of providing stronger correction than the voice coils at higher frequencies. Second order low-pass notch filters are present on both actuators at \SI{800}{\hertz} to prevent excitation of the first suspension violin mode.}
\end{figure}

\subsubsection{ETM suspension gain heirarchy}
\note{Discuss in much more detail the implementation of coil and ETM crossover - show TFs of the suspension from each stage to the test mass, and the actuators to the test mass, and talk about how the actuator filters were constructed from these}

Before being sent to the actuators, the driving filter outputs are converted into the analogue domain using appropriate \gls{DAC} gain and noise injection stages. The conversion from voltage to force is represented by gain stages at the input to each suspension block.

The suspension block contains three inputs, each representing a different passive filtering stage of the suspension system. These input signals are mapped to a single output representing the displacement of each \gls{ETM}, and these signals are fed back to the interferometer block, completing the loop.

\subsection{Loop Gain}

The open loop gain of the control system is shown in Figure\,\ref{fig:open-loop-gain}. The greatest gain is required in the region below \SI{10}{\hertz} where the test mass suspensions provide little to no isolation from seismic noise. Above this frequency the required gain decreases as other noise sources become dominant. The unity gain frequency is at \SI{350}{\hertz}.

\begin{figure}
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-controller-open-loop-gain.pdf}
  \caption{\label{fig:open-loop-gain}Simulated \SSM{} controller open loop gain. The majority of the gain is applied to correct displacements due to seismic noise below \SI{10}{\hertz}. The unity gain frequency is \SI{350}{\hertz} and the phase margin is \SI{44}{\degree}.}
  % phase margin calculated with script graphics/scripts/open-loop-gain/phaseMargin.py
\end{figure}

\section{\label{app:parameters}Experimental parameters}
The parameters used in the simulations presented in this work are shown in Table\,\ref{tab:parameters}. Unless otherwise stated, the mirrors specified in the figures and simulations are assumed to have unity reflectivity. All listed transmissivities represent power, no substrate loss is assumed for any optic and all simulations have been performed using the plane-wave approximation.
% FWHM, finesse etc. calculations from Finesse simulation for SSM with the 'maxtem 0' and 'trace 2' commands.

\begin{table}
  \centering
  \begin{tabular}{ll}
    \textbf{Parameter}   & \textbf{Fiducial value} \\
    Laser wavelength $\lambda_{0}$        & \SI{1064}{\nano\meter} \\
    Input power             & \SI{1.8}{\watt} \\
    Round-trip cavity length $L_{\textrm{RT}}$ & \SI{2.83}{\meter} \\
    \MINT{} transmissivity & \SI{e4}{} ppm \\
    ITM transmissivity      & \SI{700}{} ppm                 \\
    Arm cavity \gls{FWHM} & \SI{12.2}{\kilo\hertz} \\
    Arm cavity finesse      & \SI{8663}{} \\
    BHD quantum efficiency  & \SI{0.95}{\ampere\per\watt} \\
    PDH quantum efficiency  & \SI{0.80}{\ampere\per\watt} \\
    \RT{}                   & \SI{10}{\kilo\ohm} \\
    PDH demodulation gain   & \SI{21}{\decibel} \\
    ADC/DAC quantisation noise  & \SI{1.8}{\micro\volt\per\sqrthz} \\
    ETM mass                & \SI{113}{\gram} \\
    ETM fibres              & \SI{4}{} \\
    ETM fibre diameter      & \SI{40}{\micro\meter} \\
    ETM fibre length        & \SI{200}{\milli\meter} \\
    ITM mass                & \SI{0.86}{\gram} \\
    ITM fibres              & \SI{2}{} \\
    ITM fibre diameter      & \SI{10}{\micro\meter} \\
    ITM fibre length        & \SI{100}{\milli\meter} \\
    Suspension vertical-to-horizontal coupling & \SI{0.01}{} \\
  \end{tabular}
  \caption{\label{tab:parameters}Experimental parameters. The properties for the suspensions and test masses are given in order for the reader to be able to reproduce the suspension thermal noise spectral density presented in Figure\,\ref{fig:noise-budget}.}
\end{table}

\section{\label{sec:noise-budget}Noise budget}

In order to show that quantum noise is reduced with respect to an equivalent Michelson interferometer, the design of the proof-of-concept \SSM{} intends for it to be the limiting noise source in a frequency band in the region of a few hundreds of \SI{}{\hertz} \cite{Graef2014}. Using the linear projection technique, each anticipated significant source of noise has been estimated and projected into differential mode displacement-equivalent noise to discover the limiting sources across the control bandwidth, and verify that the experiment will be limited by quantum noise in the intended band. The projection requires that the characteristics of the length sensing and control loop be well defined. A detailed description of the interferometer's optomechanics, signal extraction, control law and suspension and actuator dynamics is provided in Section,\ref{ssm-control-scheme}, while the computed noise budget for the differential mode is presented in Figure\,\ref{fig:noise-budget}.

\begin{figure}
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/50-speedmeter-noise-budget.pdf}
  \caption{\label{fig:noise-budget}\SSM{} differential mode noise budget for the combined filter scheme with sensing and control noise taken into account. The shaded region represents the frequency band at which the intended direct measurement of reduced quantum radiation pressure noise is to be made in the experiment. The quantum noise contribution from the PDH readout is more than an order of magnitude smaller than the total quantum noise, showing that its inclusion in the combined filter is not harmful to the overall sensitivity in this band.}
\end{figure}

The sensitivity between \SI{100}{\hertz} and \SI{700}{\hertz}, shaded in \checkme{blue}, is the quantum noise limited measurement band. This band is constrained from below by test mass suspension mechanical mode cross-couplings (not shown) and from above by the first violin mode of the ETM suspensions. Suspension thermal noise is the second highest noise source present in this band and is at most a factor of \SI{2.3}{} below quantum noise, allowing a careful direct measurement of quantum radiation pressure noise to be made in this region. The contribution to the quantum noise from the PDH feedback is far below the limiting quantum noise, showing that the use of the displacement readout as part of the combined filter presented in Section\,\ref{sec:combined-filter} does not significantly affect the sensitivity of the \SSM{} in the desired band.

\section{\label{sec:summary}Summary}

We have demonstrated that positional drifts of the cavity mirrors in the proof-of-concept \SSM{} at low frequencies due to sensing noise lead to an inability to control the cavity mirrors over time scales longer than a few hours. We have shown that this drift can be suppressed by taking a small amount of light from the path between the arm cavities to provide a displacement readout, and that this does not significantly affect the sensitivity of the main, velocity readout. A combination of the displacement and velocity readouts provides a suitable error signal for the control of the arm cavity differential mode at all relevant frequencies without spoiling the quantum non-demolition effect at higher frequencies, facilitating measurements with arbitrary integration time and allowing the \SSM{} to reach its design sensitivity.

Since the main readout of any interferometer primarily sensitive to velocity will encounter the problem of vanishing signal in the presence of flat or increasing sensing noise at low frequencies, we believe the solution presented in this work is applicable to any audio-band speed-meter.