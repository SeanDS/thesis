\chapter{\label{c:et-lf-control}Control of the low frequency Einstein Telescope detector}

\begin{itemize}
  \item Build upon the PDH stuff laid out in Chapter 3: describe the evolution of the ET-LF interferometer in order to control it: the need for a Schnupp asymmetry (to provide the equivalent of a PDH-style controller), DARM offset, etc...
  
  \item Tobin's talk at G0900745 is really good for explaining DC readout's benefits
  
  \item Talk about the need for an OMC
  
  \item See documentation from ET-LF repository, and aLIGO design study
  
  \item Also see scribblings / emails from Ken etc. around the time of the Florence meeting where we discussed the low frequency sensing problem
  
  \item See noise budget from before Florence
  
  \item Show plots of sideband powers not entering the cavities

  \item The Einstein telescope facility: ET-LF and ET-HF, the xylophone, etc.
    \begin{itemize}
      \item Unprecedented LF sensitivity: opens up universe
      \item Pushing warm technology to the limit with ET-HF
      \item Challenges: control at low frequencies with such detuning
      \item ET-LF layout
      \item Predicted sensitivity vs Optickle calculated sensitivity
      \item ISC stuff...
	\begin{itemize}
	  \item Consider only plane waves - justification: only want to control lengths for now. Angles are not considered a challenging aspect as nothing much has changed since aLIGO.
	  \item Optical response: with and without mechanical TFs - show the difference it makes to the response at low frequencies, and why it is necessary to turn them off in the case when you're computing a sensing matrix
	  \item From sensing matrix to control matrix (control loops, locking order, bandwidth, etc.)
	  \item Dynamic range of sensors and actuators in ET-LF
	  \item Problem with dynamic range, need local control or SPI or similar
	\end{itemize}
      \end{itemize}
      
  \item See p5 of VIR-0449D-11 (2011), Advanced Virgo steady state length sensing and control simulation, for description of why DARM offset is better than MICH
\end{itemize}
  
See Bryan's paper for sidebands on sidebands in the context of the Caltech prototype for aLIGO, to describe the use of beats between sidebands: https://iopscience.iop.org/article/10.1088/0264-9381/23/18/010/pdf

\section{The Einstein Telescope Facility}

\subsection{ET-LF}

\subsection{ET-HF}

\section{Control concepts}
\subsection{DC readout}
\subsubsection{Optimal operating point}
In Equation\,\ref{eq:mich-p-out} see that a static field $\frac{P_{\text{in}}}{2}$ is present upon the photodetector, independent of the arm length change. In simple experiments, often it is practical to keep the interferometer at an operating point commonly referred to as ``half way up the fringe''. Here, the interferometer's mirrors are nominally positioned such that the output signal is oscillating about the midpoint between crest and trough (see Figure\,\ref{fig:optimal-operating-point}). As the gradient is steepest at this point, any small changes to the relative arm length of the Michelson interferometer result in a significant difference in power at the photodetector. This operating point, however, is not optimal in terms of \emph{sensitivity} to arm length fluctuations. As discussed in Section\,\ref{sec:snr}, the noise level is just as important as the signal.

%% FIXME: change this plot's x-labels to use wavelength, to fit with the conclusion in the text.
\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-python/80-optimal-operating-point.pdf}
  \caption[Fringe]{\label{fig:optimal-operating-point}Optimal operating point.}
\end{figure}

By inspecting Equation\,\ref{eq:mich-p-out}, it is clear to see that there must exist, in cases where there is a signal due to a difference in arm length, a static photodetector power independent of the arm length. This does not contribute any displacement information to the measurement, but does contribute shot noise:
\begin{equation}
  P_{\text{shot, out}} = \sqrt{2 h f_0 P_{\text{in}}},
\end{equation}
where $h$ is Planck's constant, $f_0$ is the light frequency and $P_{\text{in}} = A_{\text{in}}^2$, the power entering the interferometer at the beam splitter. The optimally sensitive operating point is therefore not simply one which maximises the signal gradient, but rather one which maximises the SNR. The SNR is:
\begin{equation}
  \text{SNR} = \frac{P_{\text{out}}}{P_{\text{shot, out}}} = \sqrt{\frac{P_{\text{in}}}{4 h f_0}} \left( 1 + \cos \left(k \Delta x \right) \right).
\end{equation}

The $\Delta x$ term in Equation\,\ref{eq:mich-p-out} is a combination of a static arm length \emph{detuning}\textemdash representing the arm length mismatch required to reach the desired operating point\textemdash and a differential gravitational wave signal $\Delta x_{\text{GW}}$. A suitable choice of $ x_{\text{tune}}$ can remove the majority of the static power present at the output. Setting the slope of the SNR with respect to the tuning to zero,
\begin{equation}
  \frac{\Delta \text{SNR}}{\Delta x_{\text{GW}}} = -k \sqrt{\frac{P_{\text{in}}}{4 h f_0}} \sin \left(k \Delta x\right) = 0,
\end{equation}
we find that maximum SNR is achieved for static tunings 
\begin{equation}
  \Delta x \text{ mod } \lambda = 0.
\end{equation}
This result shows that the optimal operating point in terms of SNR is at the point where the light from the two arms interferes destructively. While any multiple of $\lambda$ will satisfy the SNR condition as defined, in reality we have not considered laser noise coupling. The more matched the arm lengths are, the lower the laser noise couples to the output port. In reality there are also mismatches in the reflectivities of the mirrors in the arms: this creates an asymmetry called a \emph{contrast defect} which leads to additional shot noise at the output port.

%CHECKME At the output port, light from one arm is transmitted through the beam splitter while the light from the other arm is reflected, and so a reflection phase convention applies (see Appendix\,\ref{a:reflection-phase}). The arm lengths are therefore offset by $\frac{\lambda}{4}$ with respect to one another.

% Section 1.3.1 of Gabriele Vajente's thesis covers this in more detail.

\subsection{Challenges}
\note{Focus on ET-LF, but discuss challenges with ET-HF too (parametric instabilities, etc.) - basically stress that there's a lot of work to be done before the technical design}

\note{Discuss that we need to model both tuned and detuned ET-LF states, as the locking will have to start with tuned}

\section{Control of an interferometer with multiple degrees of freedom}
\note{Control matrix...}

\section{Modelling ET-LF}
\note{See email sent to Andreas about outcomes of ASPERA. Basically, we had to model the interferometer controls and higher order modes, so we did it simultaneously with two tools. Discuss how this was achieved, via a shared parameter set, etc.}

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{graphics/generated/from-svg/80-darm-schnupp-offsets.pdf}
  \caption[Differential arm and Schnupp offsets in a \DRFPMI{}]{\label{fig:darm-schnupp-offsets}Blah}
\end{figure}

\subsection{Modelling higher order modes and parametric instabilities}
\note{Finesse...}

\subsection{Modelling control loops}
\note{Optickle + SimulinkNb}
Optickle facilitates the modelling of control loops in a number of ways. The primary output from an Optickle simulation is the interferometer matrix, describing the mapping of every degree of freedom of the interferometer to every probe within the interferometer. As such, with this matrix it is possible to construct the signals produced by the various readouts within the interferometer, and these can be manually propagated through electronics to calculate the signal characteristics in a controller. Furthermore, Optickle is written in Matlab and so benefits from the \emph{Simulink} and \emph{Control Systems} toolboxes provided as extensions, with which it is possible to define control loops around the interferometer plant and perform linearisation to calculate loop gains and transfer functions. With a little effort, this process can be automated in a script. However, an \gls{LSC} tool developed for \gls{LIGO}, \emph{SimulinkNb}, became available in 2015 and acts as an interface between Optickle and Simulink. It is primarily designed to calculate out-of-loop noise budgets for an interferometer model defined within Optickle, and as a consequence of this it is able to model control loops.

\subsection{Combined modelling effort}
It was decided that the best approach to combine the benefits of the two tools would be to develop identical models with both Finesse and Optickle...

\subsection{Recycling cavity lengths and RF sidebands}
\note{Defined sideband frequencies...}

\note{Discuss how we chose to follow Advanced LIGO as much as possible, but had to define some as-yet undefined parameters first}

\section{Conceptual control scheme}

\note{Put the control matrices here: show the slopes of the error signals for tuned and detuned operation}

\section{Control noise}
\note{Highlight the dynamic range problem with photodetectors sensing the low frequency motion (poster from Florence), and introduce the basic control loop developed with SimulinkNb - discuss the noises included, the assumptions made, etc. Finish with the list from the poster of what has to be done: further modelling of suspension SPIs, or better sensors, or both, etc...}

\subsection{Seismic noise in ET-LF}
\note{Take transfer function through S.A. from lowest noise site measured...}
\note{Assume optimal worst contribution of noise to ETMs...}

\section{Outlook}

\subsection{Future upgrades to ET}
\note{SSM, Stefan D's idea for triangular speed meter, etc...}